<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ParabÃ©ns Juliana</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #000;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
            font-family: 'Courier New', Courier, monospace;
        }

        canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 99;
        }

        #player {
            position: absolute;
            top: -9999px;
            left: -9999px;
        }

        /* Estilo do GIF Surpresa */
        #gif-surpresa {
            position: absolute;
            z-index: 50;
            /* Fica atrÃ¡s do confete (99) mas na frente do fundo */
            display: none;
            /* ComeÃ§a escondido */
            max-width: 80%;
            /* NÃ£o ocupa a tela toda para nÃ£o esconder 100% do texto */
            max-height: 80vh;
            border-radius: 15px;
            box-shadow: 0 0 50px rgba(0, 255, 0, 0.5);
            /* Glow verde para combinar */
        }

        #overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 99999;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #0f0;
            font-size: 20px;
            font-weight: bold;
            cursor: pointer;
            flex-direction: column;
            text-align: center;
        }

        .marquee-container {
            white-space: nowrap;
            overflow: hidden;
            position: absolute;
            width: 100%;
            z-index: 60;
            /* Texto fica na frente do GIF */
        }

        .marquee-text {
            display: inline-block;
            font-size: 25vw;
            font-weight: bold;
            color: #0f0;
            text-shadow: 0 0 10px #0f0;
            padding-left: 100%;
            animation: scroll-left 15s linear infinite;
            transform: translate3d(0, 0, 0);
        }

        @keyframes scroll-left {
            0% {
                transform: translate3d(0, 0, 0);
            }

            100% {
                transform: translate3d(-100%, 0, 0);
            }
        }
    </style>
</head>

<body>
    <div id="overlay" onclick="iniciarSistema()">
        <div>TOQUE PARA INICIAR<br><span style="font-size:12px; color:#666">(NecessÃ¡rio para liberar o Ã¡udio)</span>
        </div>
    </div>

    <div id="player"></div>

    <img id="gif-surpresa" src="juliana.gif" alt="Surpresa">

    <div class="marquee-container">
        <div class="marquee-text" id="texto">
            ParabÃ©ns Juliana ğŸ‰ ğŸ‚ ğŸ¥³ ğŸ¥‚ ğŸ¾ ğŸŠ ğŸˆ ğŸ ğŸ’– ğŸ’
        </div>
    </div>

    <script>
        // --- CONFIGURAÃ‡ÃƒO ---
        var BUCKET_ID = "Nx4eX6XbVusH98XQ86tkpg";
        var KEY = "mensagem";
        var URL_BASE = "https://kvdb.io/" + BUCKET_ID + "/" + KEY;
        var MUSIC_ID = "DOWyEY-VfIw";

        // Define o texto inicial na variÃ¡vel tambÃ©m, para evitar "piscada" se o banco demorar
        var textoAtual = "ParabÃ©ns Juliana ğŸ‰ ğŸ‚ ğŸ¥³ ğŸ¥‚ ğŸ¾ ğŸŠ ğŸˆ ğŸ ğŸ’– ğŸ’";
        var velocidadeAtual = "";
        var player;
        var audioLiberado = false;
        var musicaTocando = false;

        var tag = document.createElement('script');
        tag.src = "https://www.youtube.com/iframe_api";
        var firstScriptTag = document.getElementsByTagName('script')[0];
        firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

        function onYouTubeIframeAPIReady() {
            player = new YT.Player('player', {
                height: '1', width: '1', videoId: MUSIC_ID,
                playerVars: { 'playsinline': 1, 'controls': 0, 'loop': 1 }
            });
        }

        function iniciarSistema() {
            document.getElementById('overlay').style.display = 'none';
            audioLiberado = true;
            if (player && player.playVideo) {
                player.mute(); player.playVideo();
                setTimeout(function () { player.pauseVideo(); player.unMute(); }, 500);
            }
            verificarDados();
        }

        function dispararConfete() {
            if (typeof confetti === 'undefined') return;
            var duration = 3 * 1000; var end = Date.now() + duration;
            (function frame() {
                confetti({ particleCount: 5, angle: 60, spread: 55, origin: { x: 0 }, colors: ['#f00', '#0f0', '#00f'] });
                confetti({ particleCount: 5, angle: 120, spread: 55, origin: { x: 1 }, colors: ['#f00', '#0f0', '#00f'] });
                if (Date.now() < end) requestAnimationFrame(frame);
            }());
        }

        function verificarDados() {
            var urlComCacheBuster = URL_BASE + "?t=" + new Date().getTime();

            fetch(urlComCacheBuster)
                .then(function (r) { return r.text(); })
                .then(function (dadosRaw) {
                    var dados;
                    try { dados = JSON.parse(dadosRaw); }
                    catch (e) { dados = { texto: dadosRaw, velocidade: 15 }; }

                    if (dados.texto && dados.texto !== textoAtual) {
                        textoAtual = dados.texto;
                        document.getElementById('texto').innerText = textoAtual;

                        var t = textoAtual.toLowerCase().trim();
                        var gifEl = document.getElementById('gif-surpresa');

                        // --- LÃ“GICA DO GATILHO COMPLETO ---
                        if (t === "te amo" || t === "teamo") {
                            // 1. Solta Confete
                            dispararConfete();

                            // 2. Mostra o GIF
                            gifEl.style.display = "block";

                            // 3. Toca MÃºsica
                            if (audioLiberado && player && player.playVideo && !musicaTocando) {
                                player.seekTo(0); player.setVolume(100); player.playVideo();
                                musicaTocando = true;
                            }
                        } else {
                            // SE NÃƒO FOR O GATILHO:
                            // Esconde o GIF
                            gifEl.style.display = "none";

                            // Para a mÃºsica
                            if (musicaTocando && player && player.pauseVideo) {
                                player.pauseVideo();
                                musicaTocando = false;
                            }
                        }
                    }

                    if (dados.velocidade && String(dados.velocidade) !== String(velocidadeAtual)) {
                        velocidadeAtual = dados.velocidade;
                        document.getElementById('texto').style.animationDuration = velocidadeAtual + 's';
                    }
                })
                .catch(function (e) { console.log("Erro: " + e); });
        }

        setInterval(verificarDados, 5000);
    </script>
</body>

</html>